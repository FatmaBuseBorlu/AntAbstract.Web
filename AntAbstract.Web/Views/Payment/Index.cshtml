@using AntAbstract.Domain.Entities
@model AntAbstract.Domain.Entities.Payment

@{
    ViewData["Title"] = "Ödeme";
    Layout = "_LayoutDashboard";

    var slug = ViewContext.RouteData.Values["slug"]?.ToString();
}

<style>
    .payment-card {
        border: none;
        border-radius: 12px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.05);
    }

    .section-title {
        color: #00aeef;
        font-weight: 700;
        border-bottom: 2px solid #f0f0f0;
        padding-bottom: 10px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
    }

        .section-title i {
            background-color: rgba(0, 174, 239, 0.1);
            padding: 8px;
            border-radius: 50%;
            margin-right: 10px;
        }

    .form-control, .form-select {
        border-radius: 8px;
        padding: 10px 15px;
        border: 1px solid #e0e0e0;
    }

        .form-control:focus {
            border-color: #00aeef;
            box-shadow: 0 0 0 4px rgba(0, 174, 239, 0.1);
        }

    .summary-card {
        background-color: #f8f9fa;
        border-radius: 12px;
        padding: 20px;
    }

    .total-price {
        color: #00aeef;
        font-size: 1.5rem;
        font-weight: 800;
    }
</style>

<div class="container-fluid">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="fw-bold mb-1">Ödeme Ekranı</h4>
            <p class="text-muted small mb-0">Lütfen fatura bilgilerinizi giriniz ve ödeme yöntemini seçiniz.</p>
        </div>
        <a href="/Dashboard" class="btn btn-outline-secondary btn-sm">
            <i class="fas fa-times me-1"></i> İptal
        </a>
    </div>

    <div class="alert alert-primary border-0 shadow-sm d-flex align-items-center mb-4" role="alert" style="background-color: #eef9fe; color: #0056b3;">
        <i class="fas fa-info-circle fs-4 me-3"></i>
        <div>
            <strong>Ödeme Yapılacak Etkinlik:</strong> <br>
            @if (Model.Conference != null)
            {
                <span>@Model.Conference.Title</span>
            }
            else
            {
                <span>Kongre Kaydı</span>
            }
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="card payment-card bg-white p-4 mb-4">

                <form method="post"
                      asp-action="ProcessPayment"
                      asp-route-slug="@slug">

                    <input type="hidden" asp-for="ConferenceId" />
                    <input type="hidden" asp-for="RelatedSubmissionId" />

                    <h5 class="section-title"><i class="fas fa-file-invoice"></i> Fatura Bilgileri</h5>

                    <div class="row g-3 mb-4">
                        <div class="col-md-12">
                            <label class="form-label small fw-bold text-muted">Ad Soyad / Unvan</label>
                            <input asp-for="BillingName" class="form-control" placeholder="Fatura kime kesilecek?" required />
                            <span asp-validation-for="BillingName" class="text-danger small"></span>
                        </div>

                        <div class="col-md-12">
                            <label class="form-label small fw-bold text-muted">Fatura Adresi</label>
                            <textarea asp-for="BillingAddress" class="form-control" rows="2" placeholder="Tam adres..." required></textarea>
                        </div>

                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted">Vergi Dairesi (Opsiyonel)</label>
                            <input asp-for="TaxOffice" class="form-control" placeholder="Kurumsal ise giriniz" />
                        </div>

                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted">Vergi Numarası (Opsiyonel)</label>
                            <input asp-for="TaxNumber" class="form-control" placeholder="Kurumsal ise giriniz" />
                        </div>
                    </div>

                    <h5 class="section-title"><i class="far fa-credit-card"></i> Kart Bilgileri</h5>

                    <div class="row g-3 mb-4">
                        <div class="col-md-12">
                            <label class="form-label small fw-bold text-muted">Kart Sahibi</label>
                            <input type="text" class="form-control" placeholder="Kartın üzerindeki isim" required />
                        </div>

                        <div class="col-md-12">
                            <label class="form-label small fw-bold text-muted">Kart Numarası</label>
                            <div class="input-group">
                                <span class="input-group-text bg-white border-end-0"><i class="fas fa-credit-card text-muted"></i></span>
                                <input type="text" class="form-control border-start-0" placeholder="0000 0000 0000 0000" required />
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted">Son Kullanma (AA/YY)</label>
                            <input type="text" class="form-control" placeholder="MM/YY" required />
                        </div>

                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted">CVV / CVC</label>
                            <input type="text" class="form-control" placeholder="123" required />
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary w-100 py-3 fw-bold shadow-sm" style="background-color: #00aeef; border:none; font-size: 1.1rem;">
                        <i class="fas fa-lock me-2"></i> @Model.Amount.ToString("N2") @Model.Currency GÜVENLİ ÖDE
                    </button>

                </form>
            </div>

            <div class="card payment-card bg-white p-4">
                <h6 class="fw-bold text-dark mb-3"><i class="fas fa-university me-2"></i> Alternatif: Banka Havalesi</h6>
                <p class="small text-muted mb-2">Kredi kartı kullanmak istemiyorsanız, aşağıdaki IBAN numarasına havale yapabilirsiniz.</p>
                <div class="alert alert-light border small mb-0">
                    <strong>Alıcı:</strong> AntAbstract Kongre Hizmetleri <br>
                    <strong>IBAN:</strong> TR00 0000 0000 0000 0000 0000 00 <br>
                    <strong>Açıklama:</strong> Lütfen açıklama kısmına <u>Adınızı Soyadınızı</u> ve <u>Kongre Adını</u> yazınız.
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card payment-card summary-card border-0 sticky-top" style="top: 100px; z-index: 1;">
                <h5 class="fw-bold mb-3 text-dark">Sipariş Özeti</h5>

                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-muted">Kayıt Ücreti</span>
                    <span class="fw-bold">@Model.Amount.ToString("N2") @Model.Currency</span>
                </div>

                <div class="d-flex justify-content-between align-items-center mb-3">
                    <span class="text-muted">Hizmet Bedeli</span>
                    <span class="fw-bold">0.00 @Model.Currency</span>
                </div>

                <hr class="my-3">

                <div class="d-flex justify-content-between align-items-center">
                    <span class="fs-5 fw-bold text-dark">TOPLAM</span>
                    <span class="total-price">@Model.Amount.ToString("N2") @Model.Currency</span>
                </div>

                <div class="mt-4 text-center">
                    <small class="text-muted d-block mb-2">
                        <i class="fas fa-shield-alt me-1"></i> 256-bit SSL ile korunmaktadır.
                    </small>
                    <div class="opacity-50">
                        <i class="fab fa-cc-visa fa-2x mx-1"></i>
                        <i class="fab fa-cc-mastercard fa-2x mx-1"></i>
                        <i class="fab fa-cc-amex fa-2x mx-1"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
